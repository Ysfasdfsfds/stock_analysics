import{d as A,a as v,r as D,c as _,b as r,e as t,g as b,f as K,w as l,i as a,h as q,k as i,t as V,v as T,E as S,u as j,o as g,q as z,p as G,_ as H}from"./index-BRQ1HDww.js";const J={class:"register-container"},O={class:"register-card"},Q={key:0,class:"step-content"},W={key:1,class:"step-content"},X={class:"step-buttons"},Y={key:2,class:"step-content"},Z={class:"register-summary"},h={class:"step-buttons"},ee={class:"register-footer"},te=A({__name:"RegisterView",setup(se){const U=j(),k=v(),x=v(),n=v(0),y=v(!1),w=v(!1),u=v(""),s=D({inviteCode:"",username:"",email:"",password:"",confirmPassword:""}),F={inviteCode:[{required:!0,message:"请输入邀请码",trigger:"blur"},{min:6,message:"邀请码长度不能少于6个字符",trigger:"blur"}]},P={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度不能少于3个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(d,e,m)=>{e!==s.password?m(new Error("两次输入的密码不一致")):m()},trigger:"blur"}]};async function B(){try{await k.value.validate(),y.value=!0,u.value="";const d=await T(s.inviteCode);d.valid?(S.success("邀请码验证成功"),n.value=1):u.value=d.message||"邀请码无效"}catch(d){u.value=d.response?.data?.message||"邀请码验证失败"}finally{y.value=!1}}async function E(){try{await x.value.validate(),n.value=2}catch{}}async function M(){try{w.value=!0,u.value="",await z(s.username,s.email,s.password,s.inviteCode),S.success("注册成功，欢迎加入！"),U.push("/")}catch{u.value=G.value||"注册失败，请稍后再试"}finally{w.value=!1}}return(d,e)=>{const m=a("el-step"),N=a("el-steps"),c=a("el-input"),p=a("el-form-item"),f=a("el-button"),R=a("el-form"),C=a("el-descriptions-item"),I=a("el-descriptions"),$=a("el-alert"),L=a("router-link");return g(),_("div",J,[r("div",O,[e[16]||(e[16]=r("div",{class:"register-header"},[r("h2",null,"注册账号"),r("p",null,"创建您的股票分析系统账号")],-1)),t(N,{active:n.value,"finish-status":"success",simple:""},{default:l(()=>[t(m,{title:"验证邀请码"}),t(m,{title:"填写账号信息"}),t(m,{title:"完成注册"})]),_:1},8,["active"]),n.value===0?(g(),_("div",Q,[t(R,{ref_key:"inviteCodeForm",ref:k,model:s,rules:F,"label-position":"top",onSubmit:q(B,["prevent"])},{default:l(()=>[t(p,{label:"邀请码",prop:"inviteCode"},{default:l(()=>[t(c,{modelValue:s.inviteCode,"onUpdate:modelValue":e[0]||(e[0]=o=>s.inviteCode=o),placeholder:"请输入邀请码","prefix-icon":"Key"},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(f,{type:"primary","native-type":"submit",loading:y.value,class:"step-button"},{default:l(()=>[...e[8]||(e[8]=[i(" 验证邀请码 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):b("",!0),n.value===1?(g(),_("div",W,[t(R,{ref_key:"accountForm",ref:x,model:s,rules:P,"label-position":"top",onSubmit:q(E,["prevent"])},{default:l(()=>[t(p,{label:"用户名",prop:"username"},{default:l(()=>[t(c,{modelValue:s.username,"onUpdate:modelValue":e[1]||(e[1]=o=>s.username=o),placeholder:"请输入用户名","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),t(p,{label:"邮箱",prop:"email"},{default:l(()=>[t(c,{modelValue:s.email,"onUpdate:modelValue":e[2]||(e[2]=o=>s.email=o),placeholder:"请输入邮箱",type:"email","prefix-icon":"Message"},null,8,["modelValue"])]),_:1}),t(p,{label:"密码",prop:"password"},{default:l(()=>[t(c,{modelValue:s.password,"onUpdate:modelValue":e[3]||(e[3]=o=>s.password=o),placeholder:"请输入密码",type:"password","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),t(p,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[t(c,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=o=>s.confirmPassword=o),placeholder:"请再次输入密码",type:"password","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[r("div",X,[t(f,{onClick:e[5]||(e[5]=o=>n.value=0)},{default:l(()=>[...e[9]||(e[9]=[i("上一步",-1)])]),_:1}),t(f,{type:"primary","native-type":"submit"},{default:l(()=>[...e[10]||(e[10]=[i("下一步",-1)])]),_:1})])]),_:1})]),_:1},8,["model"])])):b("",!0),n.value===2?(g(),_("div",Y,[r("div",Z,[e[11]||(e[11]=r("h3",null,"确认您的注册信息",-1)),t(I,{column:1,border:""},{default:l(()=>[t(C,{label:"用户名"},{default:l(()=>[i(V(s.username),1)]),_:1}),t(C,{label:"邮箱"},{default:l(()=>[i(V(s.email),1)]),_:1}),t(C,{label:"邀请码"},{default:l(()=>[i(V(s.inviteCode),1)]),_:1})]),_:1})]),r("div",h,[t(f,{onClick:e[6]||(e[6]=o=>n.value=1)},{default:l(()=>[...e[12]||(e[12]=[i("上一步",-1)])]),_:1}),t(f,{type:"primary",onClick:M,loading:w.value},{default:l(()=>[...e[13]||(e[13]=[i(" 完成注册 ",-1)])]),_:1},8,["loading"])])])):b("",!0),u.value?(g(),K($,{key:3,title:u.value,type:"error","show-icon":"",closable:!0,onClose:e[7]||(e[7]=o=>u.value=""),style:{"margin-top":"1rem"}},null,8,["title"])):b("",!0),r("div",ee,[r("p",null,[e[15]||(e[15]=i("已有账号？",-1)),t(L,{to:"/login"},{default:l(()=>[...e[14]||(e[14]=[i("立即登录",-1)])]),_:1})])])])])}}}),oe=H(te,[["__scopeId","data-v-30a23208"]]);export{oe as default};
