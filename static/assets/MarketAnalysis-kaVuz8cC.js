import{Q as B,d as T,a as h,B as p,C as N,H as z,I as H,c as g,b as e,g as k,e as s,w as o,i as v,E as b,l as O,L,k as Q,D as w,t as d,o as x,_ as U}from"./index-BRQ1HDww.js";import{T as j}from"./TrendChart-f0RR5B7j.js";async function q(_,l){try{return(await B.get("http://127.0.0.1:5001/api/sh-a/stock/000001/index_zh_a_hist",{params:{start_date:_,end_date:l}})).data}catch(i){throw console.error("获取上证A股指数历史数据失败:",i),i}}function G(_){return _.map(l=>({date:l.date,日期:l.日期,开盘点位:l.开盘,收盘点位:l.收盘,最低点位:l.最低,最高点位:l.最高,成交量:l.成交量,成交额:l.成交额,涨跌幅:l.涨跌幅,涨跌额:l.涨跌额,振幅:l.振幅,换手率:l.换手率}))}const J={class:"market-analysis","element-loading-text":"正在加载大盘数据..."},K={class:"page-header"},P={class:"header-content"},R={class:"header-actions"},W={key:0,class:"latest-data-section"},X={class:"metric-card"},Y={class:"metric-card"},Z={class:"metric-value"},$={class:"metric-card"},ee={class:"metric-value"},te={class:"metric-card"},se={class:"metric-value"},ae={class:"metric-card"},le={class:"metric-value"},oe={class:"metric-card"},re={class:"metric-value"},de={class:"metric-card"},ie={class:"metric-value"},ne={class:"metric-card"},ce={class:"metric-value"},ue={key:1,class:"charts-section"},ve={class:"chart-header"},_e={class:"chart-controls"},me={class:"chart-container"},fe=T({__name:"MarketAnalysis",setup(_){const l=h(!1),i=h([]),r=p(()=>i.value.length>0?i.value[i.value.length-1]:null),m=h(["收盘点位","成交量"]),D=p(()=>m.value.map(a=>{switch(a){case"收盘点位":return{key:"收盘点位",value:"收盘点位",color:"#409EFF"};case"开盘点位":return{key:"开盘点位",value:"开盘点位",color:"#67C23A"};case"最高点位":return{key:"最高点位",value:"最高点位",color:"#E6A23C"};case"最低点位":return{key:"最低点位",value:"最低点位",color:"#F56C6C"};case"涨跌幅":return{field:"涨跌幅",name:"涨跌幅",color:"#909399"};case"成交量":return{key:"成交量",value:"成交量",color:"#9370DB"};case"成交额":return{key:"成交额",value:"成交额",color:"#FF6347"};default:return{key:a,value:a,color:"#409EFF"}}})),C=p(()=>G(i.value));function S(a){return a>=1e8?(a/1e8).toFixed(2)+"亿":a>=1e4?(a/1e4).toFixed(2)+"万":a.toString()}function V(a){return a>=1e11?(a/1e12).toFixed(2)+"万亿":a>=1e8?(a/1e8).toFixed(2)+"亿":a>=1e4?(a/1e4).toFixed(2)+"万":a.toString()}async function y(){l.value=!0;try{const a=new Date().toISOString().split("T")[0],t=new Date(Date.now()-4320*60*60*1e3).toISOString().split("T")[0],u=await q(t,a);u.code===200&&u.data?i.value=u.data:b.error("获取上证指数数据失败: "+u.message)}catch(a){console.error("获取上证指数数据出错:",a),b.error("获取上证指数数据出错")}finally{l.value=!1}}function A(){y()}return N(()=>{y()}),(a,t)=>{const u=v("el-button"),f=v("el-card"),n=v("el-col"),F=v("el-row"),c=v("el-option"),I=v("el-select"),E=H("loading");return z((x(),g("div",J,[e("div",K,[s(f,{shadow:"hover"},{default:o(()=>[e("div",P,[t[2]||(t[2]=e("div",{class:"market-info"},[e("h1",{class:"market-title"},"上证A股指数 大盘分析"),e("p",{class:"market-subtitle"},"实时行情与历史趋势分析")],-1)),e("div",R,[s(u,{onClick:A,loading:l.value,icon:O(L),type:"primary"},{default:o(()=>[...t[1]||(t[1]=[Q("刷新数据",-1)])]),_:1},8,["loading","icon"])])])]),_:1})]),r.value?(x(),g("div",W,[s(f,{shadow:"hover"},{header:o(()=>[e("h3",null,"最新行情数据 ("+d(r.value.date)+")",1)]),default:o(()=>[s(F,{gutter:20,class:"metrics-grid"},{default:o(()=>[s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",X,[e("div",{class:w(["metric-value price",{up:r.value.涨跌幅>0,down:r.value.涨跌幅<0}])},d(r.value.收盘.toFixed(2)),3),t[3]||(t[3]=e("div",{class:"metric-label"},"收盘点位",-1)),e("div",{class:w(["metric-change",{up:r.value.涨跌幅>0,down:r.value.涨跌幅<0}])},d(r.value.涨跌幅>0?"+":"")+d(r.value.涨跌幅.toFixed(2))+"% ",3)])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",Y,[e("div",Z,d(r.value.开盘.toFixed(2)),1),t[4]||(t[4]=e("div",{class:"metric-label"},"开盘点位",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",$,[e("div",ee,d(r.value.最高.toFixed(2)),1),t[5]||(t[5]=e("div",{class:"metric-label"},"最高点位",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",te,[e("div",se,d(r.value.最低.toFixed(2)),1),t[6]||(t[6]=e("div",{class:"metric-label"},"最低点位",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",ae,[e("div",le,d(r.value.振幅.toFixed(2))+"%",1),t[7]||(t[7]=e("div",{class:"metric-label"},"振幅",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",oe,[e("div",re,d(S(r.value.成交量)),1),t[8]||(t[8]=e("div",{class:"metric-label"},"成交量",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",de,[e("div",ie,d(V(r.value.成交额)),1),t[9]||(t[9]=e("div",{class:"metric-label"},"成交额",-1))])]),_:1}),s(n,{xs:12,sm:8,md:6,lg:4},{default:o(()=>[e("div",ne,[e("div",ce,d(r.value.换手率.toFixed(2))+"%",1),t[10]||(t[10]=e("div",{class:"metric-label"},"换手率",-1))])]),_:1})]),_:1})]),_:1})])):k("",!0),i.value.length>0?(x(),g("div",ue,[s(F,{gutter:20},{default:o(()=>[s(n,{span:24},{default:o(()=>[s(f,{shadow:"hover"},{header:o(()=>[e("div",ve,[t[11]||(t[11]=e("h3",null,"上证指数趋势分析",-1)),e("div",_e,[s(I,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=M=>m.value=M),multiple:"",placeholder:"选择指标",style:{width:"300px"}},{default:o(()=>[s(c,{label:"收盘点位",value:"收盘点位"}),s(c,{label:"开盘点位",value:"开盘点位"}),s(c,{label:"最高点位",value:"最高点位"}),s(c,{label:"最低点位",value:"最低点位"}),s(c,{label:"涨跌幅",value:"涨跌幅"}),s(c,{label:"成交量",value:"成交量"}),s(c,{label:"成交额",value:"成交额"})]),_:1},8,["modelValue"])])])]),default:o(()=>[e("div",me,[s(j,{data:C.value,"date-field":"date",yFields:D.value,defaultSelectedFields:m.value,height:"500px",title:"上证指数趋势"},null,8,["data","yFields","defaultSelectedFields"])])]),_:1})]),_:1})]),_:1})])):k("",!0)])),[[E,l.value]])}}}),ge=U(fe,[["__scopeId","data-v-da3920a0"]]);export{ge as default};
